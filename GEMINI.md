# Gemini Context: @alexasomba/better-auth-paystack

> **Note:** Use `context7` for the most up-to-date documentation and specialized skills related to this project.

## Project Overview
This is a TypeScript library that provides a **Paystack** integration plugin for **Better Auth**. It enables seamless customer creation, secure checkout, webhook verification, and subscription flows for applications using Better Auth. It is designed to work with modern frameworks like Next.js, Tanstack Start, Hono, and Cloudflare Workers.

## Key Features
- **Customer Creation**: Optional Paystack customer creation on user sign-up.
- **Checkout**: Paystack checkout via transaction initialize + verify.
- **Webhooks**: Secure webhook signature verification (`HMAC-SHA512`).
- **Subscriptions**: Management of subscriptions (create, enable, disable) and synchronization with local database.
- **Configuration**: Dynamic configuration sharing between server and client.

## Tech Stack
- **Language**: TypeScript
- **Package Manager**: pnpm
- **Build Tool**: tsdown
- **Testing**: vitest
- **Core Dependencies**: `better-auth`, `@alexasomba/paystack-node`, `better-call`, `zod`

## Project Structure
- `src/`
  - `index.ts`: **Server-side Plugin Entry**. Defines the `paystack` plugin, endpoints (webhooks, transactions), and database hooks.
  - `client.ts`: **Client-side Plugin Entry**. Defines the `paystackClient` for typed API access on the frontend.
  - `routes.ts`: Implementation of the plugin's API routes.
  - `schema.ts`: Database schema definitions/extensions for Better Auth.
  - `paystack-sdk.ts`: Wrapper/Utilities for the Paystack SDK.
- `examples/`: Contains example applications demonstrating usage.
  - `nextjs/`: Example using Next.js.
  - `tanstack/`: Example using Tanstack Start.
- `dist/`: Compiled output (generated by build).
- `scripts/`: Utility scripts (e.g., for build or dev tasks).

## Development Workflow

### Key Commands
| Command | Description |
| :--- | :--- |
| `pnpm install` | Install dependencies. |
| `pnpm build` | Build the library using `tsdown`. |
| `pnpm dev` | Run the library in watch mode for development. |
| `pnpm test` | Run unit tests using `vitest`. |
| `pnpm test:integration` | Run integration tests. |
| `pnpm typecheck` | Run TypeScript type checking. |
| `pnpm lint:package` | Lint the package structure using `publint`. |

### Conventions
- **Workspaces**: This project uses pnpm workspaces.
- **Linting**: Strict linting rules are enforced.
- **Testing**: Integration tests are separate from unit tests (use `pnpm test:integration`).
- **Exports**: The package exports both a main entry point (`.`) and a client entry point (`./client`).

## Usage Context
This library is intended to be used as a plugin within a `better-auth` configuration.
1.  **Server**: Import `paystack` from `@alexasomba/better-auth-paystack` and add it to the `plugins` array in `betterAuth()`.
2.  **Client**: Import `paystackClient` from `@alexasomba/better-auth-paystack/client` and add it to `createAuthClient()`.
3.  **Database**: The plugin extends the `user` and `subscription` tables in the Better Auth database schema.

Refer to `README.md` for detailed configuration options and API usage.
